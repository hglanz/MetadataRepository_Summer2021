library(ISLR)
set.seed(100)
train = college[sample(1:777, 500, replace=F),]
college <- College
set.seed(100)
train = college[sample(1:777, 500, replace=F),]
test = college[-sample(1:777, 500, replace=F),]
#gam fit
gam1 = lm(Outstate ~ bs(Room.Board, df=4)+bs(Books, knots=c(475, 600))+bs(Terminal, df=6)+bs(perc.alumni, knots=c(10,30))+bs(log(train$Expend), knots=c(8.5,10))+bs(train$Grad.Rate, df=6), data=train); summary(gam1)
library(splines)
#gam fit
gam1 = lm(Outstate ~ bs(Room.Board, df=4)+bs(Books, knots=c(475, 600))+bs(Terminal, df=6)+bs(perc.alumni, knots=c(10,30))+bs(log(train$Expend), knots=c(8.5,10))+bs(train$Grad.Rate, df=6), data=train); summary(gam1)
#predict
test_frame =cbind(test[,c("Room.Board","Books","Terminal","perc.alumni","Expend","Grad.Rate")])
gam_predict = predict(gam1, test_frame)
gam_predict = predict(gam1, test)
mysample <- sample(1:777, 500, replace=F)
train = college[mysample,]
test = college[-mysample,]
#gam fit
gam1 = lm(Outstate ~ bs(Room.Board, df=4)+bs(Books, knots=c(475, 600))+bs(Terminal, df=6)+bs(perc.alumni, knots=c(10,30))+bs(log(train$Expend), knots=c(8.5,10))+bs(train$Grad.Rate, df=6), data=train)
summary(gam1)
#predict
test_frame =cbind(test[,c("Room.Board","Books","Terminal","perc.alumni","Expend","Grad.Rate")])
gam_predict = predict(gam1, test)
gam_predict = predict(gam1, newdata = test)
#gam fit
gam1 = lm(Outstate ~ bs(Room.Board, df=4)+bs(Books, knots=c(475, 600))+bs(Terminal, df=6)+bs(perc.alumni, knots=c(10,30))+bs(log(Expend), knots=c(8.5,10))+bs(Grad.Rate, df=6), data=train)
gam_predict = predict(gam1, newdata = test)
library(tidyverse)
?summarise)
?summarise
?country_code
install.packages("countrycode")
library(countrycode)
?country_code
?countrycode
?codelist
2.5989/(4.7854/12)
2.5989/(4.7854)
2.5989/5.3646
install.packages(c(
"gapminder", "ggforce", "globals", "openintro", "shiny",
"shinycssloaders", "shinyFeedback", "shinythemes", "testthat",
"thematic", "tidyverse", "vroom", "waiter", "xml2", "zeallot"
))
98/110
96/110
88/110
90/110
92/110
80/110
81/110
library(gbm)
1500+3000+6000+6000+3000+3000+6500
104.5/125
115/125
install.packages("blogdown")
x <- rpois(10, 5)
y <- rpoise(10, 3)
set.seed(1)
x <- rpois(10, 5)
y <- rpoise(10, 3)
y <- rpois(10, 3)
erin_cor <- function(x, y) {
corval <- (sum((x - mean(x, na.rm = T))*
(y - mean(y, na.rm = T))))/
((sqrt(sum((x - mean(x, na.rm = T))^2)))*
(sqrt(sum((y - mean(y, na.rm = T))^2))))
return(corval)
}
cor(x, y)
erin_cor(x, y)
x[5] <- NA
cor(x, y)
erin_cor(x, y)
set.seed(1)
x <- rpois(10, 5)
y <- rpois(10, 3)
# lag_df <- juvenile %>%
# mutate(central_ca = dplyr::lag(central_ca, n = i)) %>% drop_na()
erin_cor <- function(x, y) {
na_inds <- c(which(is.na(x)), which(is.na(y)))
x <- x[-na_inds]
y <- y[-na_inds]
corval <- (sum((x - mean(x, na.rm = T))*
(y - mean(y, na.rm = T))))/
((sqrt(sum((x - mean(x, na.rm = T))^2)))*
(sqrt(sum((y - mean(y, na.rm = T))^2))))
return(corval)
}
cor(x, y)
erin_cor(x, y)
x[5] <- NA
cor(x, y, na.rm = T)
erin_cor(x, y)
set.seed(1)
x <- rpois(10, 5)
y <- rpois(10, 3)
# lag_df <- juvenile %>%
# mutate(central_ca = dplyr::lag(central_ca, n = i)) %>% drop_na()
erin_cor <- function(x, y) {
na_inds <- c(which(is.na(x)), which(is.na(y)))
if (length(na_inds) > 0) {
x <- x[-na_inds]
y <- y[-na_inds]
}
corval <- (sum((x - mean(x, na.rm = T))*
(y - mean(y, na.rm = T))))/
((sqrt(sum((x - mean(x, na.rm = T))^2)))*
(sqrt(sum((y - mean(y, na.rm = T))^2))))
return(corval)
}
cor(x, y)
erin_cor(x, y)
x[5] <- NA
cor(x, y, na.rm = T)
erin_cor(x, y)
set.seed(1)
x <- rpois(10, 5)
y <- rpois(10, 3)
# lag_df <- juvenile %>%
# mutate(central_ca = dplyr::lag(central_ca, n = i)) %>% drop_na()
erin_cor <- function(x, y) {
na_inds <- c(which(is.na(x)), which(is.na(y)))
if (length(na_inds) > 0) {
x <- x[-na_inds]
y <- y[-na_inds]
}
corval <- (sum((x - mean(x, na.rm = T))*
(y - mean(y, na.rm = T))))/
((sqrt(sum((x - mean(x, na.rm = T))^2)))*
(sqrt(sum((y - mean(y, na.rm = T))^2))))
return(corval)
}
cor(x, y)
erin_cor(x, y)
ccf(x, y)
x[5] <- NA
cor(x, y, na.rm = T)
erin_cor(x, y)
ccf(x, y)
z <- ccf(x, y)
z
-6 %% 3
install.packages("prettydoc")
?read.csv
install.packages("readr")
library(readr)
str(mtcars)
summary(mtcars)
mtcars %>%
summarize(mean(mpg))
library(tidyverse)
mtcars %>%
summarize(mean(mpg))
mean(mtcars$mpg)
mtcars %>%
summarize(vars(hp, mpg)
funs(mean, median))
mtcars %>%
summarize(vars(hp, mpg),
funs(mean, median))
mtcars %>%
summarize_at(vars(hp, mpg),
funs(mean, median))
mtcars %>%
mutate(
hp_per_cyl = hp/cyl
) %>%
str()
mtcars_new <- mtcars %>%
mutate(
hp_per_cyl = hp/cyl
) %>%
str()
mtcars_new %>%
arrange(hp)
mtcars_new <- mtcars %>%
mutate(
hp_per_cyl = hp/cyl
)
mtcars_new %>%
arrange(hp)
mtcars_new %>%
top_n(3, hp)
mtcars_new %>%
select(cyl, hp_per_cyl) %>%
arrange(hp_per_cyl)
mtcars_new %>%
select(-cyl, -hp) %>%
arrange(hp_per_cyl)
mtcars_new %>%
select(-cyl, -hp_per_cyl) %>%
arrange(hp_per_cyl)
mtcars_new %>%
arrange(hp_per_cyl) %>%
select(-cyl, -hp_per_cyl)
mtcars_new %>%
select(cyl, hp_per_cyl) %>%
filter(cyl == 6) %>%
arrange(hp_per_cyl)
mtcars_new %>%
select(cyl, hp_per_cyl) %>%
# filter(cyl == 6) %>%
arrange(hp_per_cyl)
mtcars %>%
ggplot(aes(x = hp, y = mpg)) +
geom_point()
mtcars %>%
ggplot(aes(x = hp, y = mpg, color = cyl)) +
geom_point()
mtcars %>%
ggplot(aes(x = hp, y = mpg, color = as.character(cyl))) +
geom_point()
mtcars %>%
ggplot(aes(x = hp, y = mpg)) +
geom_point()
mtcars %>%
ggplot(aes(x = hp, y = mpg), color = "cornflowerblue") +
geom_point()
mtcars %>%
ggplot(aes(x = hp, y = mpg)) +
geom_point(color = "cornflowerblue")
mtcars %>%
ggplot(aes(x = hp, y = mpg)) +
geom_point(color = "cornflowerblue", shape = 2)
mtcars
mtcars %>%
gather(key = "Engine_Metric", value = "Value", -cyl)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(randomForest)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# library(randomForest)
x <- 5
# setwd("/Hunter/Desktop")
summary(cars)
x
install.packages("shiny")
install.packages("shiny")
library(dbplyr)
install.packages("rmarkdown")
install.packages("rmarkdown")
library(tidyverse)
shiny::runApp('C:/Users/Hunter/Desktop/trainingpart2/trainingpart2')
runApp('C:/Users/Hunter/Desktop/trainingpart2/trainingpart2')
mtcars
iris
names(iris)
names(mtcars)
iris
setdiff(names(iris), "Species")
names(mtcars)
names(iris)
names(iris)
"Sepal.Length"
iris[, c("Sepal.Length", "Sepal.Width")]
tempdata <- iris[, c("Sepal.Length", "Sepal.Width")]
kmeans(tempdata, 3)
tempclusters <- kmeans(tempdata, 3)
tempclusters$centers
tempclusters$cluster
?points
runApp('C:/Users/Hunter/Desktop/trainingpart2/mtcars_clustering')
runApp('C:/Users/Hunter/Desktop/trainingpart2/mtcars_clustering')
temp_c <- 10
temp_f <- function() {
message("Converting")
(temp_c + 32) * 9 / 5
}
temp_f()
temp_c <- -3
temp_f()
runApp('C:/Users/Hunter/Desktop/trainingpart2/mtcars_clustering')
runApp('C:/Users/Hunter/Desktop/trainingpart2/mtcars_clustering')
summary(mtcars$mpg)
library(ggplot2)
library(tidyverse)
clusters <- kmeans(mtcars[, c("hp", "mpg")])
mtcars %>%
ggplot(aes(x = hp, y = mpg, col = clusters$cluster, shape = cyl)) +
geom_point()
clusters <- kmeans(mtcars[, c("hp", "mpg")], 3)
mtcars %>%
ggplot(aes(x = hp, y = mpg, col = clusters$cluster, shape = cyl)) +
geom_point()
mtcars %>%
ggplot(aes(x = hp, y = mpg, col = clusters$cluster, shape = as.character(cyl))) +
geom_point()
mtcars %>%
ggplot(aes(x = hp, y = mpg, col = as.character(clusters$cluster), shape = as.character(cyl))) +
geom_point()
mtcars %>%
ggplot(aes_string(x = "hp", y = "mpg", col = as.character(clusters$cluster), shape = as.character("cyl"))) +
geom_point()
mtcars %>%
ggplot(aes_string(x = "hp", y = "mpg", col = as.character(clusters$cluster), shape = "cyl")) +
geom_point()
rlang::last_error()
mtcars_new <- mtcars %>%
mutate(
cyl_c = as.character(cyl)
)
mtcars_new %>%
ggplot(aes_string(x = "hp", y = "mpg", col = as.character(clusters$cluster), shape = "cyl_c")) +
geom_point()
View(mtcars_new)
mtcars_new <- mtcars %>%
mutate(
cyl_c = as.character(cyl)
)
mtcars_new %>%
ggplot(aes_string(x = "hp", y = "mpg", col = as.character(clusters$cluster), shape = cyl)) +
geom_point()
mtcars_new <- mtcars %>%
mutate(
cyl_c = as.character(cyl)
)
mtcars_new %>%
ggplot(aes_string(x = "hp", y = "mpg", col = as.factor(clusters$cluster), shape = "cyl_c")) +
geom_point()
clusters$centers
mtcars %>%
mutate(
cyl_c = as.character(cyl)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = as.factor(clusters$cluster), shape = "cyl_c")) +
geom_point() +
geom_point(data = clusters$centers, aes_string(x = "hp", y = "mpg"))
mtcars
nrow(mtcars)
clusters$cluster
length(clusters$cluster)
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = clusters$cluster
)
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = clusters$cluster
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point()
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point()
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point() +
geom_point(data = clusters$centers, aes_string(x = "hp", y = "mpg"))
clusters$centers
d <- clusters$centers
d <- data.frame(clusters$centers)
d
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point() +
geom_point(data = data.frame(clusters$centers), aes_string(x = "hp", y = "mpg"))
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point()
clusters$centers
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point() +
geom_point(data = data.frame(clusters$centers), aes_string(x = "hp", y = "mpg"))
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point() +
geom_point(data = as.data.frame(clusters$centers), aes_string(x = "hp", y = "mpg"))
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point()
ggplot(as.data.frame(clusters$centers), aes_string(x = "hp", y = "mpg")) +
geom_point()
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point() +
geom_point(data = as.data.frame(clusters$centers), aes_string(x = "hp", y = "mpg"))
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point() +
geom_point(data = as.data.frame(clusters$centers), aes_string(x = "hp", y = "mpg"))
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "cluster", shape = "cyl_c")) +
geom_point()
View(clusters)
mtcars %>%
mutate(
cyl_c = as.character(cyl),
cluster = as.character(clusters$cluster)
)
tempclusters <- kmeans(mtcars[, c(input$xcol, input$ycol)], 3)
mtcars_new <- mtcars %>%
mutate(
cyl_c = as.character(cyl)
)
mtcars %>%
mutate(
cyl_c = as.character(cyl),
car_clusters = as.character(tempclusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "car_clusters", shape = "cyl_c")) +
geom_point() +
geom_point(data = as.data.frame(tempclusters$centers), aes_string(x = "hp", y = "mpg"))
as.character(tempclusters$cluster)
tempclusters <- kmeans(mtcars[, c("hp", "mpg")], 3)
mtcars_new <- mtcars %>%
mutate(
cyl_c = as.character(cyl)
)
mtcars %>%
mutate(
cyl_c = as.character(cyl),
car_clusters = as.character(tempclusters$cluster)
) %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "car_clusters", shape = "cyl_c")) +
geom_point() +
geom_point(data = as.data.frame(tempclusters$centers), aes_string(x = "hp", y = "mpg"))
mtcars_new <- mtcars %>%
mutate(
cyl_c = as.character(cyl),
car_clusters = as.character(tempclusters$cluster)
)
mtcars_new %>%
ggplot(aes_string(x = "hp", y = "mpg", col = "car_clusters", shape = "cyl_c")) +
geom_point() +
geom_point(data = as.data.frame(tempclusters$centers), aes_string(x = "hp", y = "mpg"))
runApp('F:/Dropbox/Hunter/FlashDrive-64GB/CalPoly-prof/Conferences_Talks/WUSS/2021/SAS-Plus-R-Class_2021/WUSS21_SASRTrainingPart2_Glanz/Part2_Code/mtcars_clustering_v2')
?factor
library(tidyverse)
?mutate_if
iris %>%
select(-Sepal.Width) %>%
mutate_if(is.numeric, floor) %>%
bind_cols(Sepal.Width)
iris %>%
select(-Sepal.Width) %>%
mutate_if(is.numeric, floor) %>%
bind_cols(iris$Sepal.Width)
iris <- iris %>%
select(-Sepal.Width) %>%
mutate_if(is.numeric, floor) %>%
bind_cols(iris$Sepal.Width)
View(iris)
iris
mutate(across(where(is.numeric), ~na_if(.x, -1))
)
library(tidyverse)
mtcars2 <- mtcars %>%
mtuate(across(where(is.numeric) & !mpg, as.factor)) %>%
mutate(across(where(is.numeric), ~na_if(.x, -1)))
mtcars2 <- mtcars %>%
mutate(across(where(is.numeric) & !mpg, as.factor)) %>%
mutate(across(where(is.numeric), ~na_if(.x, -1)))
mtcars2
str(mtcars2)
mtcars %>%
ggplot(aes(x = hp, y = mpg)) +
geom_point()
setwd("F:/Dropbox/Hunter/FlashDrive-64GB/CalPoly-prof/Research/MyProjects/DataRepository/Data/")
list.files()
myfiles <- list.files()
myfiles <- list.files()
data <- list()
for (i in 1:length(myfiles)) {
data[[i]] <- read.csv(myfiles[i])
}
